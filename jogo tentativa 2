<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <title>Dengue Zero</title>
        <style type="text/css">
            
            @import url('https://fonts.cdnfonts.com/css/arcade-classic');

            body {
                display: flex;
                justify-content: center;
                align-items: center;
                margin: 0;
                background-color: #59c449;
                overflow-y: hidden;
                font-family: 'ArcadeClassic', sans-serif;
            }

            img {
                height: 100vh;
                width: 100vw;
                padding: 0;
                
                -webkit-background-size: contain;
                -moz-background-size: contain;
                background-size: contain;
                -o-background-size: contain;
            }

            .cronometro {
                display: none;
                flex-direction: column;
                align-items: center;
                text-align: center;
                align-content: center;
                border-radius: 15px;
                border-color: black;
                background-color: antiquewhite;
                margin: 0;
                padding: 0;
                width: 13%;
                height: 4vh;
                position: absolute;
                top: 5%;
                right: 3%;
            }

            .instrucoes {
                position: absolute;
                display: none;
            }

            .gameOver {
                position: absolute;
                display: none;
            }

            .mapa {
                position: absolute;
                display: none;
            }

            .faseOvo {
                background-image: url("https://i.imgur.com/gEgtlBl.png");
                background-size: cover;
                display: flex;
            }

            .faseLarva {
                background-image: url("https://i.imgur.com/FGiaNxR.png");
                background-size: cover;
                display: flex;
            }

            .fasePupa {
                background-image: url("https://i.imgur.com/x4VjAMR.png");
                background-size: cover;
                display: flex;
            }

            .faseAdulta {
                background-image: url("https://i.imgur.com/Eia1PkO.png");
                background-size: cover;
                display: flex;
            }


            .telhado {
                display: flex;
                position: absolute;
                background-color: transparent;
                height: 8vh;
                width: 8vw;
                border-radius: 15px;
                border-width: 2px;
            }

            .questionario {
                display: none;
                position: absolute;
                background-color: aliceblue;
                height: 18vh;
                width: 100vw;
                border-radius: 15px;
                border-color: black;
                bottom: 0%;
                font-size: 18px;
                padding-left: 10px;
                padding-bottom: 0px;
                padding-top: 0px;
                align-items: center;
                justify-content: center;
            }

            .opcao {
                background-color: rgb(40, 119, 93);
                border-radius: 15px;
                border-color: black;
                align-items: baseline;
                align-self: center;
                justify-self: baseline;
                font-size: 18px;
                font-family: 'ArcadeClassic', sans-serif;
            }

            #contador {
                font-size: 10px;
                font-family: 'ArcadeClassic', sans-serif;
                justify-content: right;
            }

            #separador {
                font-size: 1px;
            }

            #telhado1 {
                position: absolute;
                display: block;
                top: 7%;
                left: 30%;
            }

            #telhado2 {
                position: absolute;
                display: block;
                top: 34%;
                left: 18%;
            }

            #telhado3 {
                position: absolute;
                display: block;
                top: 26%;
                left: 50%;
            }

            #telhado4 {
                position: absolute;
                display: block;
                top: 52%;
                left: 18%;
            }

            #telhado5 {
                position: absolute;
                display: block;
                top: 60%;
                left: 48%;
            }

            #imagemFundo {
                display: block;
            }

            #separador {
                font-family: 'ArcadeClassic', sans-serif;
                font-size: 3vh;
                font-weight: bold;
                align-self: center;
            }

            #displayMin {
                top: 1px;
                right: 5px;
                font-size: 4vh;
                font-family: 'ArcadeClassic', sans-serif;
            }

            #displaySeg {
                top: 1px;
                right: 5px;
                font-size: 4vh;
                font-family: 'ArcadeClassic', sans-serif;
            }

            #botaoIniciar {
                position: absolute;
                bottom: 17%;
                right: 42vw;
                background-color: #59c449;
                border-radius: 10px;
                font-size: 5vh;
                font-family: 'ArcadeClassic', sans-serif;
            }

            #botaoReiniciar {
                position: absolute;
                bottom: 17%;
                right: 42vw;
                background-color: #59c449;
                border-radius: 10px;
                font-size: 5vh;
                font-family: 'ArcadeClassic', sans-serif;
            }

        </style>
    </head>
    <body> 
        <img id='imagemFundo' src="https://i.imgur.com/9O3cbfV.png" alt="Fundo Jogo">

        <div class="instrucoes">
            <img src="https://i.imgur.com/p1jg3id.png" alt="instrucoes">
            <button id="botaoIniciar">Iniciar</button>
        </div>

        <div class="mapa">
            <img id="mapa" src="https://i.imgur.com/JKp1LKo.png" alt="mapa">
        </div>

        <div class="telhado" id="telhado1"></div>
        <div class="telhado" id="telhado2"></div>
        <div class="telhado" id="telhado3"></div>
        <div class="telhado" id="telhado4"></div>
        <div class="telhado" id="telhado5"></div>

        <div class="cronometro">
                <span id = "displayMin" class = "minutos"></span><span id = "separador">:</span><span id = "displaySeg" class = "segundos"></span>
        </div>
        <div class="questionario">
            <p class="pergunta" id="textoPergunta"></p>
            <span id="contador"></span>
            <p id="separador"></p>
            <button class="opcao" id="opcaoA"></button>
            <button class="opcao" id="opcaoB"></button>
            <button class="opcao" id="opcaoC"></button>
        </div>

        <div class="gameOver">
            <img src="https://i.imgur.com/mFEemaF.png" alt="instrucoes">
            <button id="botaoReiniciar">Reiniciar</button>
        </div>
        
        <script>
            
            var botao = document.getElementById('botaoIniciar');
            var botaoReiniciar = document.getElementById('botaoReiniciar');
            var segIniciais = 121;
            var telhados = document.querySelectorAll('.telhado');
            var faseOvo = document.querySelectorAll('.faseOvo');
            var faseLarva = document.querySelectorAll('.faseLarva');
            var fasePupa = document.querySelectorAll('.fasePupa');
            var faseAdulta = document.querySelectorAll('.faseAdulta');   
            var minTotal;
            var segInterval;
            
            botao.onclick = function () {
                var imagemFundo = document.querySelector('.mapa');
                imagemFundo.src = 'https://i.imgur.com/JKp1LKo.png';
                imagemFundo.style.display = 'block';
                var cronometroDiv = document.querySelector('.cronometro');
                cronometroDiv.style.display = 'block';
                iniciarTimer();
                surgirFoco();
                setInterval(surgirFoco, 10000);
                quadroQuestionarios.style.display = 'block';
                mostrarPergunta();
                quadroQuestionarios.style.display = 'block';
                setTimeout(mostrarPergunta, 1000);
            };

            function mostrarInstrucoes() {
                var instrucoesDiv = document.querySelector('.instrucoes');
                instrucoesDiv.style.display = 'block';
            };

            window.addEventListener('load', function() {
                setTimeout(mostrarInstrucoes, 1500);
            });

            function iniciarTimer() {
                segInterval = setInterval(segundos, 1000);
            }

            function atualizaTempo(segIniciais) {
                var spanMin = document.getElementById('displayMin');
                var spanSeg = document.getElementById('displaySeg');
                minTotal = Math.floor(segIniciais / 60); // Calcula minutos a partir dos segundos restantes
                var segundosRestantes = segIniciais % 60;

                spanMin.textContent = minTotal < 10 ? '0' + minTotal : minTotal;
                spanSeg.textContent = segundosRestantes < 10 ? '0' + segundosRestantes : segundosRestantes;
            } 

            var numeroInicio = 1

            function surgirFoco() {
                faseOvo.forEach(function(faseOvo) {
                    faseOvo.classList.remove('faseOvo');
                });

                var numeroProximo = numeroInicio ++;

                var telhadoAleatorio = document.getElementById('telhado' + numeroProximo);
                
                telhadoAleatorio.classList.add('faseOvo');

                setTimeout(atualizarFaseOvo, 24000);      
            }

            function atualizarFaseOvo() {
                var faseAtualOvo = document.querySelectorAll('.faseOvo');
                faseAtualOvo.forEach(function(faseOvo) {
                    faseOvo.classList.remove('faseOvo');
                    faseOvo.classList.add('faseLarva');
                });

                setInterval(atualizarFaseLarva, 18000);
            }

            function atualizarFaseLarva() {
                var faseAtualLarva = document.querySelectorAll('.faseLarva');
                faseAtualLarva.forEach(function(faseLarva) {
                    faseLarva.classList.remove('faseLarva');
                    faseLarva.classList.add('fasePupa');
                });

                setInterval(atualizarFasePupa, 8000);
            }

            function atualizarFasePupa() {
                var faseAtualPupa = document.querySelectorAll('.fasePupa');
                faseAtualPupa.forEach(function(fasePupa) {
                    fasePupa.classList.remove('fasePupa');
                    fasePupa.classList.add('faseAdulta')
                })
            }

            var perguntas = [
                {
                    pergunta: "Qual destas nao e transmitida pelo Aedes Aegypti?",
                    alternativaA: "Dengue", 
                    alternativaB: "Febre amarela", 
                    alternativaC:"Leptospirose",
                    alternativaCerta: "Leptospirose",
                    numeroPergunta: 0,
                },
                {
                    pergunta: "Onde estao os focos do mosquito?",
                    alternativaA: "Lugares com agua parada", 
                    alternativaB: "Na terra", 
                    alternativaC: "No ar",
                    alternativaCerta: "Lugares com agua parada",
                    numeroPergunta: 1,
                },
                {
                    pergunta: "O que colocar nos pratos de vasos de plantas para evitar focos do mosquito?",
                    alternativaA: "Detergente", 
                    alternativaB: "Areia", 
                    alternativaC: "Agua",
                    alternativaCerta: "Areia", 
                    numeroPergunta: 2,
                },
                {
                    pergunta: "Onde você deve procurar ajuda se estiver com suspeita de Dengue?",
                    alternativaA: "Shopping", 
                    alternativaB: "Mercado", 
                    alternativaC: "Posto de saude, UPA ou hospitais",
                    alternativaCerta: "Posto de saude, UPA ou hospitais",
                    numeroPergunta: 3,
                },
                {
                    pergunta:  "Clique na informacao falsa:",
                    alternativaA: "So se contrai dengue uma vez na vida",
                    alternativaB: "Bromelias sao exemplos de possiveis focos do mosquito", 
                    alternativaC: "Não e recomendável tomar nenhum medicamento por conta propria",
                    alternativaCerta: "So se contrai dengue uma vez na vida",
                    numeroPergunta: 4,
                },
                {
                    pergunta: "Qual das doenças a seguir, transmitidas pelo mosquito, possui vacina?",
                    alternativaA: "Dengue", 
                    alternativaB: "Febre amarela", 
                    alternativaC: "Zika virus",
                    alternativaCerta: "Febre amarela", 
                    numeroPergunta: 5,
                },
                {
                    pergunta: "6",
                    alternativaA: "f", 
                    alternativaB: "g", 
                    alternativaC: "h",
                    alternativaCerta: "f", 
                    numeroPergunta: 6,
                },
            ];
            
            var numeroPergunta = 0;
            var quadroQuestionarios = document.querySelector('.questionario');
            var opcaoEscolhida;

            function mostrarPergunta() {
                
                var botaoA = document.getElementById('opcaoA');
                var botaoB = document.getElementById('opcaoB');
                var botaoC = document.getElementById('opcaoC');
                var perguntaElement = document.getElementById('textoPergunta');
                var perguntaAtual = perguntas[numeroPergunta].pergunta;
                var alternativaA = perguntas[numeroPergunta].alternativaA;
                var alternativaB = perguntas[numeroPergunta].alternativaB;
                var alternativaC = perguntas[numeroPergunta].alternativaC;
                perguntaElement.textContent = perguntaAtual;
                botaoA.textContent = perguntas[numeroPergunta].alternativaA;
                botaoB.textContent = perguntas[numeroPergunta].alternativaB;
                botaoC.textContent = perguntas[numeroPergunta].alternativaC;

                botaoA.onclick = function () {
                    opcaoEscolhida = perguntas[numeroPergunta].alternativaA;
                    verificarResposta();
                };

                botaoB.onclick = function () {
                    opcaoEscolhida = perguntas[numeroPergunta].alternativaB;
                    verificarResposta();
                };

                botaoC.onclick = function () {
                    opcaoEscolhida = perguntas[numeroPergunta].alternativaC;
                    verificarResposta();
                };   
                
                if (numeroPergunta === 6) {
                    mostrarGameOver();
                }

                var acertos = 0;
                var erros = 0;
                var textoContador = document.getElementById('contador');
                textoContador.textContent = "Acertos: " + acertos +" | Erros: " + erros;
            }

            function verificarResposta() {
                if (numeroPergunta < 6) {

                    if (opcaoEscolhida == perguntas[numeroPergunta].alternativaCerta) {
                        acertos ++;
                        segIniciais += 5;
                    }

                    if (opcaoEscolhida != perguntas[numeroPergunta].alternativaCerta) {
                        erros ++;
                        segIniciais -= 15;
                    }

                    numeroPergunta++;
                    mostrarPergunta();
                    atualizaTempo(segIniciais);
                }
            }

            function mostrarGameOver() {
                    var gameOver = document.querySelector('.gameOver');
                    gameOver.style.display = 'block';
                    botaoReiniciar = document.getElementById('botaoReiniciar'),
                    botaoReiniciar.onclick = function () {
                    clearInterval(segInterval);
                    window.location.href = window.location.origin + window.location.pathname;
                    }
            };

            function segundos() {
                if (segIniciais >= 0) {
                    segIniciais--;
                    atualizaTempo(segIniciais);
                    if (todosTelhadosComMosquitosAdultos()) {
                            mostrarGameOver();
                    }; 
                    if (segIniciais === 0) {
                        clearInterval(segInterval);
                        mostrarGameOver();
                    }
                }
            }

            function todosTelhadosComMosquitosAdultos() {
                for (var i = 1; i <= 5; i++) {
                    var telhado = document.getElementById('telhado' + i);
                    if (!telhado.classList.contains('faseAdulta')) {
                        return false;
                    }
                }
                return true;
            }

        </script>
    </body>
</html>